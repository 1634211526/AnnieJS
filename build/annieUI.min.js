var __extends=this&&this.__extends||function(e,t){function a(){this.constructor=e}for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},annieUI;!function(e){var t=annie.Sprite,a=annie.Shape,i=function(e){function i(i,n,r,s){void 0===s&&(s=!0),e.call(this),this.isVertical=!0,this.viewWidth=0,this.viewHeight=0,this.maxDistance=1040,this.distance=0,this.minDis=2,this.maskObj=new a,this.view=new t,this.lastValue=0,this.speed=0,this.addSpeed=0,this.isStop=!0,this.maxSpeed=100,this.fSpeed=20,this.paramXY="y",this.stopTimes=-1,this.isMouseDown=!1,this.autoScroll=!1;var o=this;o._instanceType="annieUI.ScrollPage",o.maskObj.alpha=0,o.addChild(o.maskObj),o.addChild(o.view),o.view.mask=o.maskObj,o.maxDistance=r,o.setViewRect(i,n,s),o.addEventListener(annie.MouseEvent.MOUSE_DOWN,o.onMouseEvent.bind(o)),o.addEventListener(annie.MouseEvent.MOUSE_MOVE,o.onMouseEvent.bind(o)),o.addEventListener(annie.MouseEvent.MOUSE_UP,o.onMouseEvent.bind(o)),o.addEventListener(annie.MouseEvent.MOUSE_OUT,o.onMouseEvent.bind(o)),o.addEventListener(annie.Event.ENTER_FRAME,function(){var e=o.view;if(!o.autoScroll)if(o.isStop)o.stopTimes>=0&&(o.stopTimes++,o.stopTimes>=15&&(o.speed=0,(e[o.paramXY]>0||e[o.paramXY]<o.distance-o.maxDistance)&&(o.isStop=!1,o.stopTimes=-1)));else if(Math.abs(o.speed)>0)e[o.paramXY]+=o.speed,e[o.paramXY]>0||e[o.paramXY]<o.distance-o.maxDistance?o.speed+=o.addSpeed*o.fSpeed:o.speed+=o.addSpeed,o.speed*o.addSpeed>0&&(o.speed=0);else if(0!=o.addSpeed){if(e[o.paramXY]>0||e[o.paramXY]<o.distance-o.maxDistance){var t=0;o.addSpeed>0&&o.distance<o.maxDistance&&(t=o.distance-o.maxDistance),e[o.paramXY]+=.4*(t-e[o.paramXY]),Math.abs(t-e[o.paramXY])<.1&&(o.isStop=!0,o.addSpeed>0?o.dispatchEvent("onScrollToEnd"):o.dispatchEvent("onScrollToStart"))}}else o.isStop=!0})}return __extends(i,e),i.prototype.setViewRect=function(e,t,a){var i=this;i.maskObj.clear(),i.maskObj.beginFill("#000000"),i.maskObj.drawRect(0,0,e,t),i.viewWidth=e,i.viewHeight=t,i.maskObj.endFill(),i.isVertical=a,a?(i.distance=i.viewHeight,i.paramXY="y"):(i.distance=i.viewWidth,i.paramXY="x"),i.isVertical=a},i.prototype.onMouseEvent=function(e){var t=this;if(!t.autoScroll){var a=t.view;if(e.type==annie.MouseEvent.MOUSE_DOWN)t.isStop||(t.isStop=!0),t.isVertical?t.lastValue=e.localY:t.lastValue=e.localX,t.speed=0,t.isMouseDown=!0;else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(!t.isMouseDown)return;var i=void 0;if(i=t.isVertical?e.localY:e.localX,t.speed=i-t.lastValue,t.speed>t.minDis?(t.addSpeed=-2,t.speed>t.maxSpeed&&(t.speed=t.maxSpeed)):t.speed<-t.minDis?(t.speed<-t.maxSpeed&&(t.speed=-t.maxSpeed),t.addSpeed=2):t.speed=0,0!=t.speed){var n=1;(a[t.paramXY]>0||a[t.paramXY]<t.distance-t.maxDistance)&&(n=.2),a[t.paramXY]+=(i-t.lastValue)*n}t.lastValue=i,t.stopTimes=0}else t.isMouseDown=!1,t.isStop=!1,t.stopTimes=-1}},i.prototype.scrollTo=function(e,t){void 0===t&&(t=0);var a=this;a.autoScroll=!0,a.isStop=!0,a.isMouseDown=!1;var i={};i.onComplete=function(){a.autoScroll=!1},i[a.paramXY]=e,annie.Tween.to(a.view,t,i)},i}(t);e.ScrollPage=i}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,a=function(e){function t(){e.call(this),this.maskType=0;var t=this;t._instanceType="annieUI.FacePhoto",t.photo=new Image,t.bitmap=new annie.Bitmap,t.maskObj=new annie.Shape,t.photo.onload=function(e){t.bitmap.bitmapData=t.photo,t.maskObj.clear(),t.maskObj.beginFill("#000000");var a=t.radio/(t.photo.width<t.photo.height?t.photo.width:t.photo.height);t.bitmap.scaleX=t.bitmap.scaleY=a,t.bitmap.x=t.radio-t.photo.width*a>>1,t.bitmap.y=t.radio-t.photo.height*a>>1,0==t.maskType?t.maskObj.drawCircle(t.radio>>1,t.radio>>1,t.radio>>1):t.maskObj.drawRect(0,0,t.radio,t.radio),t.maskObj.endFill(),t.dispatchEvent("onComplete")},t.addChild(t.bitmap),t.bitmap.mask=t.maskObj}return __extends(t,e),t.prototype.init=function(e,t,a){void 0===t&&(t=0),void 0===a&&(a=0);var i=this;i.radio=t,i.photo.src!=e&&(i.photo.src=e),i.maskType!=a&&(i.maskType=a)},t}(t);e.FacePhoto=a}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,a=function(e){function t(t,a,i){void 0===i&&(i=!0),e.call(this),this.listLen=0,this.view=new annie.Sprite,this.maskObj=new annie.Shape,this.slideSpeed=.3,this._isBreak=!1,this.distance=0,this.touchEndX=0,this.movingX=0,this.movingY=0,this.touchEndY=0,this.currentPageIndex=0,this.isMoving=!1,this.viewWidth=0,this.viewHeight=0,this.pageList=[],this.pageClassList=[],this.fSpeed=10,this.isMouseDown=!1,this.canSlideNext=!0,this.canSlidePrev=!0,this.paramXY="y";var n=this;n.isVertical=i,i?(n.paramXY="y",n.distance=a):(n.paramXY="x",n.distance=t),n.maskObj.alpha=0,n.addChild(n.maskObj),n.addChild(n.view),n.view.mask=n.maskObj,n.setMask(t,a);var r=n.onMouseEvent.bind(n);n.addEventListener(annie.MouseEvent.MOUSE_DOWN,r),n.addEventListener(annie.MouseEvent.MOUSE_MOVE,r),n.addEventListener(annie.MouseEvent.MOUSE_UP,r)}return __extends(t,e),t.prototype.setMask=function(e,t){var a=this;a.maskObj.clear(),a.maskObj.beginFill("#000000"),a.maskObj.drawRect(0,0,e,t),a.viewWidth=e,a.viewHeight=t,a.maskObj.endFill()},t.prototype.onMouseEvent=function(e){var t=this;if(!t.isMoving)if(e.type==annie.MouseEvent.MOUSE_DOWN)t.touchEndX=e.localX,t.touchEndY=e.localY,t.movingX=t.movingY=0,t.isMouseDown=!0,t._isBreak=!1;else if(e.type==annie.MouseEvent.MOUSE_MOVE){if(!t.isMouseDown)return;var a=e.localX-t.touchEndX,i=e.localY-t.touchEndY,n=i,r=t.movingY;t.isVertical||(n=a,r=t.movingX),Math.abs(n)-Math.abs(r)<-1&&(t._isBreak=!0),t.movingX=a,t.movingY=i,n>0&&0==t.currentPageIndex?t.view[t.paramXY]=.3*n:0>n&&t.currentPageIndex==t.listLen-1&&(t.view[t.paramXY]=-t.currentPageIndex*t.distance+.3*n)}else if(e.type==annie.MouseEvent.MOUSE_UP){if(!t.isMouseDown)return;t.isMouseDown=!1;var n=t.movingY;if(t.isVertical||(n=t.movingX),0==t.currentPageIndex&&t.view[t.paramXY]>0||t.currentPageIndex==t.listLen-1&&t.view[t.paramXY]<-t.currentPageIndex*t.distance){var s={};s[t.paramXY]=-t.currentPageIndex*t.distance,s.ease=annie.Tween.backOut,annie.Tween.to(t.view,.2,s)}else Math.abs(n)>100&&!t._isBreak&&t.slideTo(0>n)}},t.prototype.slideTo=function(e){var t=this;if(!t.isMoving){if(e){if(!(t.currentPageIndex<t.listLen-1&&t.canSlideNext))return;t.currentPageIndex++}else{if(!(t.currentPageIndex>0&&t.canSlidePrev))return;t.currentPageIndex--}t.pageList[t.currentPageIndex]||(t.pageList[t.currentPageIndex]=new t.pageClassList[t.currentPageIndex],t.pageList[t.currentPageIndex][t.paramXY]=t.currentPageIndex*t.distance),t.view.addChild(t.pageList[t.currentPageIndex]),t.view.mouseEnable=!1,t.isMoving=!0;var a={};a[t.paramXY]=-t.currentPageIndex*t.distance,a.onComplete=function(){t.view.mouseEnable=!0,t.isMoving=!1,e?t.view.removeChild(t.pageList[t.currentPageIndex-1]):t.view.removeChild(t.pageList[t.currentPageIndex+1]),t.dispatchEvent("onSlideEnd")},annie.Tween.to(t.view,t.slideSpeed,a),t.dispatchEvent("onSlideStart",{isNext:e})}},t.prototype.addPageList=function(e){var t=this;if(t.pageClassList=t.pageClassList.concat(e),0==t.listLen&&t.pageClassList.length>0){var a=new t.pageClassList[0];t.pageList.push(a),t.view.addChild(a)}t.listLen=t.pageClassList.length},t}(t);e.SlidePage=a}(annieUI||(annieUI={}));var annieUI;!function(e){var t=annie.Sprite,a=annie.Shape,i=annie.Event,n=annie.MouseEvent,r=annie.Point,s=function(e){function s(s,o,p,d){e.call(this),this.totalPage=0,this.currPage=0,this.state="stop",this.timerArg0=0,this.timerArg1=0,this.px=0,this.py=0,this.rPage0=new t,this.rPage1=new t,this.pageMC=new t,this.leftPage=null,this.rightPage=null,this.rMask0=new a,this.rMask1=new a,this.shadow0=new a,this.shadow1=new a,this.sMask0=new a,this.sMask1=new a,this.pages=[],this.stageMP=new r,this.canFlip=!0;var l=this;l._instanceType="annieUI.FlipBook",l.getPageCallback=d,l.bW=s,l.bH=o,l.totalPage=p,l.currPage=l.toPage=0,l.crossGap=Math.sqrt(l.bW*l.bW+l.bH*l.bH),l.p1=new r(0,0),l.p2=new r(0,l.bH),l.p3=new r(l.bW+l.bW,0),l.p4=new r(l.bW+l.bW,l.bH),l.limitP1=new r(l.bW,0),l.limitP2=new r(l.bW,l.bH),l.toPosArr=[l.p3,l.p4,l.p1,l.p2],l.myPosArr=[l.p1,l.p2,l.p3,l.p4],l.addChild(l.pageMC),l.addChild(l.rPage0),l.addChild(l.shadow0),l.addChild(l.rPage1),l.addChild(l.shadow1),l.rPage0.mouseEnable=!1,l.rPage1.mouseEnable=!1,l.shadow0.mouseEnable=!1,l.shadow1.mouseEnable=!1,l.setShadowMask(l.shadow0,l.sMask0,1.5*l.bW,3*l.bH),l.setShadowMask(l.shadow1,l.sMask1,1.5*l.bW,3*l.bH),l.shadow0.visible=!1,l.shadow1.visible=!1,l.rPage1.mask=l.rMask1,l.rPage0.mask=l.rMask0,l.setPage(l.currPage);var h=l.onMouseDown.bind(l),c=l.onMouseUp.bind(l),g=l.onMouseMove.bind(l),u=l.onEnterFrame.bind(l);l.addEventListener(annie.Event.ADD_TO_STAGE,function(e){l.stage.addEventListener(n.MOUSE_DOWN,h),l.stage.addEventListener(n.MOUSE_UP,c),l.stage.addEventListener(n.MOUSE_MOVE,g),l.addEventListener(i.ENTER_FRAME,u)}),l.addEventListener(annie.Event.REMOVE_TO_STAGE,function(e){l.stage.removeEventListener(n.MOUSE_DOWN,h),l.stage.removeEventListener(n.MOUSE_UP,c),l.stage.removeEventListener(n.MOUSE_MOVE,g),l.removeEventListener(i.ENTER_FRAME,u)})}return __extends(s,e),s.prototype.drawPage=function(e,t){var a,i,n=this;1==e?(t=n.checkLimit(t,n.limitP1,n.bW),t=n.checkLimit(t,n.limitP2,n.crossGap),i=n.getBookArr(t,n.p1,n.p2),a=i[1],n.getLayerArr(t,a,n.p1,n.p2,n.limitP1,n.limitP2),n.getShadow(n.shadow0,n.sMask0,n.p1,t,[n.p1,n.p3,n.p4,n.p2],.5),n.getShadow(n.shadow1,n.sMask1,n.p1,t,n.layer1Arr,.45),n.rPage1.rotation=n.angle(t,a)+90,n.rPage1.x=i[3].x,n.rPage1.y=i[3].y,n.rPage0.x=n.p1.x,n.rPage0.y=n.p1.y):2==e?(t=n.checkLimit(t,n.limitP2,n.bW),t=n.checkLimit(t,n.limitP1,n.crossGap),i=n.getBookArr(t,n.p2,n.p1),a=i[1],n.getLayerArr(t,a,n.p2,n.p1,n.limitP2,n.limitP1),n.getShadow(n.shadow0,n.sMask0,n.p2,t,[n.p1,n.p3,n.p4,n.p2],.5),n.getShadow(n.shadow1,n.sMask1,n.p2,t,n.layer1Arr,.45),n.rPage1.rotation=n.angle(t,a)-90,n.rPage1.x=i[2].x,n.rPage1.y=i[2].y,n.rPage0.x=n.p1.x,n.rPage0.y=n.p1.y):3==e?(t=n.checkLimit(t,n.limitP1,n.bW),t=n.checkLimit(t,n.limitP2,n.crossGap),i=n.getBookArr(t,n.p3,n.p4),a=i[1],n.getLayerArr(t,a,n.p3,n.p4,n.limitP1,n.limitP2),n.getShadow(n.shadow0,n.sMask0,n.p3,t,[n.p1,n.p3,n.p4,n.p2],.5),n.getShadow(n.shadow1,n.sMask1,n.p3,t,n.layer1Arr,.4),n.rPage1.rotation=n.angle(t,a)+90,n.rPage1.x=t.x,n.rPage1.y=t.y,n.rPage0.x=n.limitP1.x,n.rPage0.y=n.limitP1.y):(t=n.checkLimit(t,n.limitP2,n.bW),t=n.checkLimit(t,n.limitP1,n.crossGap),i=n.getBookArr(t,n.p4,n.p3),a=i[1],n.getLayerArr(t,a,n.p4,n.p3,n.limitP2,n.limitP1),n.getShadow(n.shadow0,n.sMask0,n.p4,t,[n.p1,n.p3,n.p4,n.p2],.5),n.getShadow(n.shadow1,n.sMask1,n.p4,t,n.layer1Arr,.4),n.rPage1.rotation=n.angle(t,a)-90,n.rPage1.x=a.x,n.rPage1.y=a.y,n.rPage0.x=n.limitP1.x,n.rPage0.y=n.limitP1.y),n.getShape(n.rMask1,n.layer1Arr),n.getShape(n.rMask0,n.layer0Arr)},s.prototype.checkLimit=function(e,t,a){var i=this,n=Math.abs(i.pos(t,e)),s=i.angle(t,e);if(n>a){var o=a*Math.sin(s/180*Math.PI),p=a*Math.cos(s/180*Math.PI);e=new r(t.x-p,t.y-o)}return e},s.prototype.getPage=function(e){var t=this;return t.pages[e-1]||(t.pages[e-1]=t.getPageCallback(e)),t.pages[e-1]},s.prototype.getBookArr=function(e,t,a){var i=this,n=[],s=Math.abs(.5*i.pos(t,e)),o=i.angle(t,e),p=s/Math.cos(o/180*Math.PI),d=new r(t.x-p,t.y),l=i.angle(e,d)-i.angle(e,a),h=i.pos(e,a),c=h*Math.sin(l/180*Math.PI),g=h*Math.cos(l/180*Math.PI),u=new r(t.x+g,t.y+c),m=i.angle(d,e),v=i.bW*Math.sin(m/180*Math.PI),w=i.bW*Math.cos(m/180*Math.PI),P=new r(u.x+w,u.y+v),M=new r(e.x+w,e.y+v);return n.push(e),n.push(u),n.push(P),n.push(M),n},s.prototype.getLayerArr=function(e,t,a,i,n,s){var o=this,p=[],d=[],l=Math.abs(.5*o.pos(a,e)),h=o.angle(a,e),c=l/Math.sin(h/180*Math.PI),g=l/Math.cos(h/180*Math.PI),u=new r(a.x-g,a.y),m=new r(a.x,a.y-c),v=t,w=Math.abs(o.pos(e,i));if(w>o.bH){p.push(v);var P=Math.abs(.5*o.pos(v,i)),M=P/Math.cos(h/180*Math.PI);m=new r(i.x-M,i.y)}else d.push(i);p.push(m),p.push(u),p.push(e),o.layer1Arr=p,d.push(s),d.push(n),d.push(u),d.push(m),o.layer0Arr=d},s.prototype.getShape=function(e,t){var a=t.length;e.clear(),e.beginFill("#000"),e.moveTo(t[0].x,t[0].y);for(var i=1;a>i;i++)e.lineTo(t[i].x,t[i].y);e.endFill()},s.prototype.setShadowMask=function(e,t,a,i){e.beginLinearGradientFill(["rgba(0,0,0,0)","rgba(0,0,0,0.6)"],[0,1],[.5*-a,4,.5*a,4]),e.drawRect(.5*-a,.5*-i,.5*a,i),e.endFill(),e.beginLinearGradientFill(["rgba(0,0,0,0)","rgba(0,0,0,0.6)"],[1,0],[.5*-a,4,.5*a,4]),e.drawRect(0,.5*-i,.5*a,i),e.endFill(),e.mask=t},s.prototype.getShadow=function(e,t,a,i,n,r){var s,o,p=this;e.visible=!0,e.x=i.x+(a.x-i.x)*r,e.y=i.y+(a.y-i.y)*r,e.rotation=p.angle(a,i),s=.5*Math.abs(a.x-i.x)/p.bW,o=1-s*s,e.scaleX=s+.1,e.alpha=o+.1,p.getShape(t,n)},s.prototype.setPage=function(e){var t=this;e>0&&e<=t.totalPage&&(t.leftPage=t.getPage(e),t.leftPage.x=t.leftPage.y=0,t.pageMC.addChild(t.leftPage)),e+1>0&&e+1<t.totalPage&&(t.rightPage=t.getPage(e+1),t.rightPage.x=t.bW,t.rightPage.y=0,t.pageMC.addChild(t.rightPage))},s.prototype.onMouseDown=function(e){var t=this;if(t.canFlip&&"stop"==t.state){t.stageMP.x=e.clientX,t.stageMP.y=e.clientY;var a=t.globalToLocal(t.stageMP);t.stageMP=a,t.timerArg0=t.checkArea(a),t.timerArg0=t.timerArg0<0?-t.timerArg0:t.timerArg0,t.timerArg0>0&&(t.timerArg0<3&&t.currPage>0||t.timerArg0>2&&t.currPage<=t.totalPage-2)&&(t.state="start",t.flushPage(),t.dispatchEvent("onFlipStart"))}},s.prototype.onMouseUp=function(e){var t=this;if("start"==t.state){t.stageMP.x=e.clientX,t.stageMP.y=e.clientY;var a=t.globalToLocal(t.stageMP);t.timerArg1=t.checkArea(a),t.state="auto",t.stageMP=a}},s.prototype.onMouseMove=function(e){var t=this;if("start"==t.state){t.stageMP.x=e.clientX,t.stageMP.y=e.clientY;var a=t.globalToLocal(t.stageMP);t.stageMP=a}},s.prototype.checkArea=function(e){var t,a=this,i=0,n=a.bW+a.bW,r=0,s=a.bH,o=50;return e.x>i&&e.x<=.5*n?(t=e.y>r&&e.y<=.5*s?1:e.y>.5*s&&e.y<s?2:0,e.x<=i+o&&(t=e.y>r&&e.y<=r+o?-1:e.y>s-o&&e.y<s?-2:t),t):e.x>.5*n&&e.x<n?(t=e.y>r&&e.y<=.5*s?3:e.y>.5*s&&e.y<s?4:0,e.x>=n-o&&(t=e.y>r&&e.y<=r+o?-3:e.y>s-o&&e.y<s?-4:t),t):0},s.prototype.flipTo=function(e){var t,a=this;e=e%2==1?e-1:e,t=e-a.currPage,"stop"==a.state&&e>=0&&e<=a.totalPage&&0!=t&&(a.timerArg0=0>t?1:3,a.timerArg1=-1,a.toPage=e>a.totalPage?a.totalPage:e,a.state="auto",a.flushPage())},s.prototype.nextPage=function(){this.flipTo(this.currPage+2)},s.prototype.prevPage=function(){this.flipTo(this.currPage-1)},s.prototype.startPage=function(){this.flipTo(0)},s.prototype.endPage=function(){this.flipTo(this.totalPage)},s.prototype.flushPage=function(){var e,t,a=this,i=a.myPosArr[a.timerArg0-1],n=null;1==a.timerArg0||2==a.timerArg0?(a.toPage=a.toPage==a.currPage?a.currPage-2:a.toPage,e=a.currPage,t=a.toPage+1,this.pageMC.removeChild(a.leftPage),a.toPage>0&&(n=a.getPage(a.currPage-2),n.x=0,a.leftPage=n,a.pageMC.addChild(n))):3!=a.timerArg0&&4!=a.timerArg0||(a.toPage=a.toPage==a.currPage?a.currPage+2:a.toPage,e=a.currPage+1,t=a.toPage,a.pageMC.removeChild(a.rightPage),a.toPage+1<a.totalPage&&(n=a.getPage(a.currPage+3),n.x=a.bW,a.rightPage=n,a.pageMC.addChild(n))),a.px=i.x,a.py=i.y,e>0&&e<=a.totalPage&&(n=a.getPage(e),n.x=0,n.y=0,a.rPage0.addChild(n)),t>0&&t<=a.totalPage&&(n=a.getPage(t),n.x=0,n.y=0,a.rPage1.addChild(n))},s.prototype.onEnterFrame=function(e){var t,a,i,n,s,o,p=this,d=p.toPosArr[p.timerArg0-1],l=p.myPosArr[p.timerArg0-1];if("start"==p.state){o=.4;var h=p.stageMP;p.px+=(h.x-p.px)*o>>0,p.py+=(h.y-p.py)*o>>0;var c=new r(p.px,p.py);p.drawPage(p.timerArg0,c)}else"auto"==p.state&&(Math.abs(d.x-p.px)>1.5*p.bW&&p.timerArg1>0?(t=l.x,a=l.y,i=0):(t=d.x,a=d.y,i=1),n=t-p.px>>0,s=a-p.py>>0,p.timerArg1<0?(o=.3,p.py=p.arc(p.bW,n,d.y)):(o=.4,p.py=s*o+p.py),p.px=n*o+p.px,p.drawPage(p.timerArg0,new r(p.px,p.py)),0==n&&0==s&&(p.rPage0.removeAllChildren(),p.rPage1.removeAllChildren(),p.shadow0.visible=!1,p.shadow1.visible=!1,p.toPage=0==i?p.currPage:p.toPage,p.currPage=p.toPage,p.pageMC.removeAllChildren(),p.setPage(p.currPage),p.state="stop",p.dispatchEvent("onFlipStop")))},s.prototype.arc=function(e,t,a){var i=2*e,n=e*e+i*i,r=Math.abs(t)-e;return a-(Math.sqrt(n-r*r)-i)},s.prototype.angle=function(e,t){var a=e.x-t.x,i=e.y-t.y,n=180*Math.atan2(i,a)/Math.PI;return 0>n?n+360:n},s.prototype.pos=function(e,t){var a=e.x-t.x,i=e.y-t.y,n=Math.sqrt(a*a+i*i);return e.x>t.x?n:-n},s}(t);e.FlipBook=s}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(t,a,i,n,r,s,o,p){void 0===s&&(s=!0),void 0===o&&(o=1),void 0===p&&(p=0),e.call(this,n,r,0,s),this._items=null,this._data=[],this.gp=new annie.Point,this.lp=new annie.Point,this.downL=null;var d=this;d._isInit=!1,d._instanceType="annieUI.ScrollList",d._itemW=a,d._itemH=i,d._items=[],d._itemClass=t,d.maxSpeed=50,d._itemCount=0,d._cols=o,d._colsDis=p,d._updateViewRect(),d.addEventListener(annie.Event.ENTER_FRAME,function(e){if(0!=d.speed){var t=null;t=d.speed<0?d._items[0]:d._items[d._items.length-1];var a=d.lp,i=d.gp;a.x=t.x,a.y=t.y,d.view.localToGlobal(a,i),d.globalToLocal(i,a);var n=0;if(d.speed<0){if(a[d.paramXY]+=d._itemRow,n=t.id+d._itemCount,n-=n%d._cols,a[d.paramXY]<0)for(var r=d._data.length,s=0;s<d._cols;s++)r>n&&(t=d._items[0],t.initData(n,d._data[n]),t[d.paramXY]=Math.floor(n/d._cols)*d._itemRow,t[d._disParam]=n%d._cols*d._itemCol,d._items.push(d._items.shift())),n++}else if(n=t.id-d._itemCount,n-=n%d._cols,a[d.paramXY]>d.distance&&n>=0)for(var s=0;s<d._cols;s++)t=d._items[d._itemCount-1],t.initData(n,d._data[n]),t[d.paramXY]=Math.floor(n/d._cols)*d._itemRow,t[d._disParam]=n%d._cols*d._itemCol,d._items.unshift(d._items.pop()),n++}})}return __extends(t,e),Object.defineProperty(t.prototype,"loadingView",{get:function(){return this.downL},enumerable:!0,configurable:!0}),t.prototype.updateData=function(e,t){void 0===t&&(t=!1);var a=this;if(!a._isInit||t?(a._data=e,a._isInit=!0):a._data=a._data.concat(e),a.flushData(),a.maxDistance=Math.ceil(a._data.length/a._cols)*a._itemRow,a.downL){a.downL[a.paramXY]=Math.max(a.distance,a.maxDistance);var i=a.downL.getWH();a.maxDistance+="x"==a.paramXY?i.width:i.height}},t.prototype.flushData=function(){var e=this,t=0;e._items.length>0&&(t=Math.abs(Math.ceil(e.view[e.paramXY]/e._itemRow))*e._cols,trace(t));for(var a=0;a<e._itemCount;a++){var i=e._items[a];i.initData(t,e._data[t]),i[e.paramXY]=Math.floor(t/e._cols)*e._itemRow,i[e._disParam]=t%e._cols*e._itemCol,t++}},t.prototype.setViewRect=function(t,a,i){e.prototype.setViewRect.call(this,t,a,i);var n=this;n._itemRow&&n._itemCol&&n._updateViewRect()},t.prototype._updateViewRect=function(){var e=this;e.isVertical?(e._disParam="x",e._itemRow=e._itemH,e._itemCol=e._itemW):(e._disParam="y",e._itemRow=e._itemW,e._itemCol=e._itemH);var t=Math.ceil(e.distance/e._itemRow)+2*e._cols;if(t!=e._itemCount){if(t>e._itemCount){var a=0;e._itemCount>0&&(a=e._items[e._itemCount-1].id+1);for(var i=e._itemCount;t>i;i++){var n=new e._itemClass;e._items.push(n),e.view.addChild(n),a++}}else for(var i=0;i<e._itemCount-t;i++)e.view.removeChild(e._items.pop());e._itemCount=t,this.flushData()}},t.prototype.setLoading=function(e){var t=this;if(t.downL){t.view.removeChild(t.downL);var a=t.downL.getWH();t.maxDistance-="x"==t.paramXY?a.width:a.height,t.downL=null}if(e){t.downL=e,t.view.addChild(e),t.downL[t.paramXY]=Math.max(t.distance,t.maxDistance);var a=t.downL.getWH();t.maxDistance+="x"==t.paramXY?a.width:a.height}else t.isStop=!1},t}(e.ScrollPage);e.ScrollList=t}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(t,a,i){void 0===i&&(i=""),e.call(this),this.context=null,this._isMouseDown=!1,this.drawColor="#000",this.bgColor="",this.drawWidth=0,this.drawHeight=0,this.totalStepList=[],this.currentStepId=0;var n=this,r=document.createElement("canvas");r.width=t,r.height=a,n.context=r.getContext("2d"),n.context.lineCap="round",n.context.lineJoin="round",n.bitmapData=r,n.drawHeight=a,n.drawWidth=t,n.reset(i);var s=n.onMouseDown.bind(n),o=n.onMouseMove.bind(n),p=n.onMouseUp.bind(n);n.addEventListener(annie.MouseEvent.MOUSE_DOWN,s),n.addEventListener(annie.MouseEvent.MOUSE_MOVE,o),n.addEventListener(annie.MouseEvent.MOUSE_UP,p)}return __extends(t,e),Object.defineProperty(t.prototype,"drawRadius",{get:function(){return this._drawRadius},set:function(e){this._drawRadius=e},enumerable:!0,configurable:!0}),t.prototype.onMouseDown=function(e){var t=this,a=t.context;a.beginPath(),a.strokeStyle=t.drawColor,a.lineWidth=t._drawRadius;var i=e.localX>>0,n=e.localY>>0;a.moveTo(i,n),t._isMouseDown=!0,t.addStepObj={},t.addStepObj.c=t.drawColor,t.addStepObj.r=t._drawRadius,t.addStepObj.sx=i,t.addStepObj.sy=n,t.addStepObj.ps=[]},t.prototype.onMouseUp=function(e){var t=this;t._isMouseDown=!1,t.addStepObj.ps.length>0&&(t.currentStepId++,t.totalStepList.push(t.addStepObj))},t.prototype.onMouseMove=function(e){var t=this;if(t._isMouseDown){var a=t.context,i=e.localX>>0,n=e.localY>>0;a.lineTo(i,n),a.stroke(),t.addStepObj.ps.push(i,n)}},t.prototype.reset=function(e){void 0===e&&(e="");var t=this;""!=e&&(t.bgColor=e),""!=t.bgColor?(t.context.fillStyle=t.bgColor,t.context.fillRect(0,0,t.bitmapData.width,t.bitmapData.height)):t.context.clearRect(0,0,t.bitmapData.width,t.bitmapData.height),t.currentStepId=0,t.totalStepList=[]},t.prototype.cancel=function(e){void 0===e&&(e=0);var t=this;if(0==e)t.reset();else{if(!(t.currentStepId-e>=0))return!1;t.currentStepId-=e,t.totalStepList.splice(t.currentStepId,e),""!=t.bgColor?(t.context.fillStyle=t.bgColor,t.context.fillRect(0,0,t.bitmapData.width,t.bitmapData.height)):t.context.clearRect(0,0,t.bitmapData.width,t.bitmapData.height);for(var a=t.totalStepList.length,i=0;a>i;i++){var n=t.context;n.beginPath(),n.strokeStyle=t.totalStepList[i].c,n.lineWidth=t.totalStepList[i].r,n.moveTo(t.totalStepList[i].sx,t.totalStepList[i].sy);for(var r=t.totalStepList.ps,s=r.length,o=0;s>o;o+=2)n.lineTo(r[o],r[o+1]),n.stroke()}}return!0},t}(annie.Bitmap);e.DrawingBoard=t}(annieUI||(annieUI={}));var annieUI;!function(e){var t=function(e){function t(t,a,i,n,r){void 0===r&&(r=50),e.call(this,t,a,i),this._drawList=[],this._totalDraw=1,this._currentDraw=0;var s=this;s.drawColor=n,s.drawRadius=r,this.addEventListener(annie.MouseEvent.MOUSE_MOVE,function(e){var t=Math.floor(e.localX/s._drawRadius),a=Math.floor(e.localY/s._drawRadius);if(s._drawList[t]&&s._drawList[t][a]){s._drawList[t][a]=!1,s._currentDraw++;var i=Math.floor(s._currentDraw/s._totalDraw*100);s.dispatchEvent("onDrawTime",{per:i})}})}return __extends(t,e),t.prototype.reset=function(t){void 0===t&&(t=""),e.prototype.reset.call(this,t);var a=this;if(a._drawList){""!=t&&(a.drawColor=t),a._currentDraw=0;var i=Math.floor(a.drawWidth/a._drawRadius),n=Math.floor(a.drawHeight/a._drawRadius);a._totalDraw=i*n;for(var r=0;i>r;r++){a._drawList[r]=[];for(var s=0;n>s;s++)a._drawList[r][s]=!0}}},t.prototype.cancel=function(e){return void 0===e&&(e=0),trace("no support"),!1},Object.defineProperty(t.prototype,"drawRadius",{set:function(e){var t=this;if(0==t._currentDraw)return void trace("已经开始刮了,无法重新设置绘画半径");if(t._drawRadius!=e){t._drawRadius=e;var a=Math.floor(t.drawWidth/e),i=Math.floor(t.drawHeight/e);t._totalDraw=a*i;for(var n=0;a>n;n++){t._drawList[n]=[];for(var r=0;i>r;r++)t._drawList[n][r]=!0}}},enumerable:!0,configurable:!0}),t}(e.DrawingBoard);e.ScratchCard=t}(annieUI||(annieUI={}));